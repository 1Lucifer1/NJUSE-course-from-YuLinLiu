## Arduino入门实验文档

##### 组号：12

##### 小组成员：黄雨晨 181250052  李镔达 181250066  刘育麟 181250090  殷德林 181250178

#### 1. 实验内容：实现按钮短按为0，长按为1，统计连续的1状态出现的次数

#### 2. 最终效果：串口监视器输出按键结果（01串）以及连续1状态出现的次数count，详情可参见拍摄的视频（实验室背景音较嘈杂望谅解）

#### 3. 实现逻辑：

以下为简略介绍，详情可参见代码

- ##### 小灯明灭

  利用中断来对按键状态进行监听，判断并改变led灯的明灭

  大体逻辑：按钮接2号口，按压导致电平改变可触发中断0，执行方法changeLight()

  在changeLight中，首先通过判断是否发生电平的变化确定是否进入控制led处理流程

  在处理逻辑中，首先进行防抖，即如果改变的时间过短判定为抖动，不进行处理，即只有按下和松开的动作持续的时间够长（>50ms）才会判定为稳定的动作，从而进行后续的处理，否则判定为抖动，不予处理。接下来通过判断变量buttonState是否发生变化以及如何变化（从按下到松开还是从松开到按下）来决定led亮暗，按下亮，松开暗

- ##### 状态统计

  关于长按和短按以及计数统计均写在press()函数中，被changeLight调用

  通过按压时长区分长按和短按（>500）

  其中用longOnesCoun进行计数，布尔值inOnes判断状态：如果从短按切换到长按（0->1），此时由于inOnes为false，则计数+1，inOnes置true，从长按切换到短按（1->0）,inOnes置false，短切短和长切长均不影响计数

  用str数组记录发生所有的按钮事件（01表示）

  每发生一次按压，将str存储内容和计数进行输出，具体可在视频中进行观测

